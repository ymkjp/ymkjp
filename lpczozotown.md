lpczozotown
===
[ymkjp/lpczozotown](https://github.com/ymkjp/lpczozotown) の作業メモ

## TODO
* [ ] 重み付けした平均 (新しければより信頼できる)
* [ ] 回帰


## Data summary

#### 各ファイルの行数
```sh
$ wc -l ST_*.csv
  124237 ST_01_RECOMMEND.csv
      95 ST_02_GROUPID.csv
 1721606 ST_03_ITEM.csv
 12050085 ST_04_LOG.csv
 13896023 total
```


#### カラムとレコード

```sh
$ head ST_*.csv | nkf -Sw
==> ST_01_RECOMMEND.csv <==
商品ID
3
141
371
739
785
831
1107
1291
1383

==> ST_02_GROUPID.csv <==
グループID
40
86
41
87
42
88
44
90
45

==> ST_03_ITEM.csv <==
商品ID,商品大分類ID,商品小分類ID,商品大分類名称,商品小分類名称,ショップID,ブランドID,ゾーンID,カラーカテゴリID,カラーカテゴリ名称
49,120,2105,音楽・本,CD,180,279,10,16,その他
61,118,2227,シューズ,シューケア/シューズ小物,341,84,1,16,その他
150,142,2128,雑貨/ホビー/スポーツ,ステーショナリー,411,161,12,1,ホワイト系
261,115,2323,アクセサリー,ピアス（片耳用）,326,819,55,14,シルバー系
371,114,2049,バッグ,ショルダーバッグ,36,26,1,2,ブラック系
421,140,2066,時計,腕時計,36,242,1,2,ブラック系
421,140,2066,時計,腕時計,36,242,1,14,シルバー系
421,140,2066,時計,腕時計,36,242,1,15,ゴールド系
421,140,2066,時計,腕時計,36,242,1,16,その他

==> ST_04_LOG.csv <==
グループID,セッションID,商品ID,購入FLG,閲覧日時
66,4709748,214277,0,2012-07-17 00:11:00.000000
66,4709766,246953,0,2012-08-02 22:50:37.000000
66,4709773,306676,0,2012-08-09 23:59:01.000000
66,4709783,246953,0,2012-08-20 00:42:17.000000
66,4709787,273670,0,2012-08-23 22:16:08.000000
66,4709788,273670,0,2012-08-24 22:49:16.000000
66,4709792,71009,0,2012-08-28 22:30:54.000000
66,4709815,56163,0,2012-09-21 22:26:33.000000
66,4709817,430524,0,2012-09-23 23:08:48.000000
```


#### 購入率
62633/12050085*100 = 0.519772267%

```sh
$ time cat ST_04_LOG.csv | nkf -Sw | awk -F"," '{ if ($4=="1") {print $0} }' | tee ~/Desktop/all_purchased.csv | wc -l
   62633
```

[all_purchased.csv](https://dl.dropboxusercontent.com/u/6998388/all_purchased.csv)


## 各種ランキング

#### Group ID (全体)

Group ID 17 が最多で 2740046/12050085*100 = 22.738810556%

```sh
$ time cat ST_04_LOG.csv | nkf -Sw | awk -F"," '{ print $1 }' | sort -n | uniq -c | sort -nr | tee ~/Desktop/ranking_group.dat | head
2740046 17
1721057 66
1564684 49
705238 51
391782 54
386534 44
355981 93
306174 21
278707 90
251415 57
```

#### Group ID (購入FLG=1)

```sh
$ time cat ST_04_LOG.csv | nkf -Sw | awk -F"," '{ if ($4=="1") {print $1} }' | sort -n | uniq -c | sort -nr | tee ~/Desktop/ranking_purchased_group.dat | head
10973 17
9435 66
4200 51
3959 49
2249 54
2116 93
1999 44
1960 21
1595 90
1518 57
```


#### Item ID (全体)

Item ID 361006 が最多で 22957/12050085*100 = 0.190513179%

```sh
$ time cat ST_04_LOG.csv | nkf -Sw | awk -F"," '{ print $3 }' | sort -n | uniq -c | sort -nr | tee ~/Desktop/ranking_item.dat | head
22957 361006
20173 97457
18831 475697
14292 358956
12265 650696
11985 426028
11682 564235
11290 261232
11169 663199
10715 374034
```

#### Item ID (購入FLG=1)

```sh
$ time cat ST_04_LOG.csv | nkf -Sw | awk -F"," '{ if ($4=="1") {print $3} }' | sort -n | uniq -c | sort -nr | tee ~/Desktop/ranking_purchased_item.dat | head
  63 684654
  45 353807
  42 4626
  38 8500
  36 309072
  34 359899
  30 437917
  30 143168
  29 121073
  28 339563
```

#### よく見られている商品

```sh
$ grep '361006' ST_03_ITEM.csv | nkf -Sw
361006,140,2066,時計,腕時計,31,1142,53,1,ホワイト系
```

#### よく買われている商品

```sh
$ grep '684654' ST_03_ITEM.csv | nkf -Sw
684654,101,2001,トップス,Tシャツ・カットソー,24,11,1,1,ホワイト系
684654,101,2001,トップス,Tシャツ・カットソー,24,11,1,2,ブラック系
684654,101,2001,トップス,Tシャツ・カットソー,24,11,1,3,グレー系
684654,101,2001,トップス,Tシャツ・カットソー,24,11,1,7,グリーン系
684654,101,2001,トップス,Tシャツ・カットソー,24,11,1,8,ブルー系
684654,101,2001,トップス,Tシャツ・カットソー,24,11,1,11,ピンク系
```








